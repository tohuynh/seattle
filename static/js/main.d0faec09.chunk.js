(this["webpackJsonpcdp-frontend"]=this["webpackJsonpcdp-frontend"]||[]).push([[0],{361:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=361},459:function(e,t,a){e.exports=a(832)},464:function(e,t,a){},832:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"getAllBodies",(function(){return Ve})),a.d(n,"getAllPeople",(function(){return Ke})),a.d(n,"getEventById",(function(){return He})),a.d(n,"getEvents",(function(){return Te})),a.d(n,"getEventsByIndexedTerm",(function(){return Ye})),a.d(n,"getVotesForPerson",(function(){return Ze}));var r=a(0),c=a.n(r),i=a(49),o=a.n(i),l=(a(464),a(149)),u=a(82),s=a(116),m=a(199),d=a(192),p=a(200),f=a(31);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(e){l.a.set(Object(f.a)({page:e},t)),l.a.pageview(e)},n=function(t){function n(){return Object(u.a)(this,n),Object(m.a)(this,Object(d.a)(n).apply(this,arguments))}return Object(p.a)(n,t),Object(s.a)(n,[{key:"componentDidMount",value:function(){a(window.location.hash.substr(1))}},{key:"componentDidUpdate",value:function(e){var t=this.props.location.pathname,n=e.location.pathname;t!==n&&a(n)}},{key:"render",value:function(){return c.a.createElement(e,this.props)}}]),n}(r.Component);return n}var v=a(39),E=a(86),b=a(858),y=a(843),w=a(8),g=w.a.h1({}),x=Object(w.a)("span")({transition:".8s all",borderRadius:"5px",padding:"1rem .5rem",":hover":{backgroundColor:"#F5F5F5",color:"black"}}),O=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{vertical:!0},c.a.createElement(y.a,null,c.a.createElement(v.b,{to:"/"},c.a.createElement(g,null,"Council Data Project")))),c.a.createElement(b.a,{vertical:!0},c.a.createElement(y.a,null,c.a.createElement(v.b,{to:"/events"},c.a.createElement(x,null,"Events")),c.a.createElement(v.b,{to:"/people"},c.a.createElement(x,{style:{marginLeft:"10px"}},"People")))))},j=a(859),k=a(860),C=a(854),S=function(){return c.a.createElement(b.a,{inverted:!0,vertical:!0,style:{padding:"5em 0em"}},c.a.createElement(y.a,null,c.a.createElement(j.a,{inverted:!0,stackable:!0},c.a.createElement(j.a.Row,{columns:"equal"},c.a.createElement(j.a.Column,null,c.a.createElement(k.a,{inverted:!0,as:"h4",content:"About"}),c.a.createElement(C.a,{link:!0,inverted:!0},c.a.createElement(C.a.Item,{as:"a"},"The Project"),c.a.createElement(C.a.Item,{as:"a"},"The Team"),c.a.createElement(C.a.Item,{as:"a"},"Other Work"))),c.a.createElement(j.a.Column,null,c.a.createElement(k.a,{inverted:!0,as:"h4",content:"Seattle"}),c.a.createElement(C.a,{link:!0,inverted:!0},c.a.createElement(C.a.Item,{as:"a"},"City of Seattle"),c.a.createElement(C.a.Item,{as:"a"},"Seattle Open Data"),c.a.createElement(C.a.Item,{as:"a"},"Seattle Channel"))),c.a.createElement(j.a.Column,null,c.a.createElement(k.a,{inverted:!0,as:"h4",content:"Developers"}),c.a.createElement(C.a,{link:!0,inverted:!0},c.a.createElement(C.a.Item,{as:"a"},"Council Data Project"),c.a.createElement(C.a.Item,{as:"a"},"Seattle Specific"),c.a.createElement(C.a.Item,{as:"a"},"Transcription Runner")))),c.a.createElement(j.a.Row,null,c.a.createElement("p",null,"This web application is not funded by, nor associated with the Seattle City Council. This is a prototype web application to show the viability of an automated and collaborativly sourced city council transcription service. The transcripts are roughly ninty-percent accurate, and therefore may not represent what was actually said.")))))},_={margin:"2em"},A={marginTop:"0.7em",whiteSpace:"pre-wrap"},I={marginTop:"0.7em"},P=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={error:null,errorInfo:null},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?c.a.createElement("div",{style:_},c.a.createElement("h2",null,"Something went wrong."),c.a.createElement("div",null,"Sorry about that. To alert us of the issue, please fill out an"," ",c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/CouncilDataProject/seattle/issues"},"issue ticket")," ","and we will try to fix it as soon as we can."),c.a.createElement("br",null),c.a.createElement("div",null,this.state.error.toString()),c.a.createElement("details",{style:A},this.state.error.stack&&c.a.createElement("section",{style:I},c.a.createElement("strong",null,"Error Stack Trace"),c.a.createElement("br",null),c.a.createElement("span",null,this.state.error.stack)),c.a.createElement("section",{style:I},c.a.createElement("strong",null,"Component Stack Trace"),c.a.createElement("span",null,this.state.errorInfo.componentStack)))):this.props.children}}]),t}(c.a.Component),R=a(14),T=a.n(R),D=a(22),B=a(844),M=a(834),F=Object(w.a)(y.a)({minHeight:"100vh"}),L=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),N=Object(w.a)(B.a)({width:"50% !important"}),U=Object(w.a)(j.a)({display:"block",marginTop:"150px !important"}),q=function(e){var t=c.a.useState(""),a=Object(D.a)(t,2),n=a[0],r=a[1];return c.a.createElement(F,null,c.a.createElement(L,null,c.a.createElement(P,null,c.a.createElement(U,{verticalAlign:"middle",centered:!0},c.a.createElement(j.a.Row,null,c.a.createElement("h1",null,"Search City Council Transcripts")),c.a.createElement(j.a.Row,null,c.a.createElement(N,{placeholder:"Enter a keyword to search meeting transcripts",value:n,onChange:function(e,t){var a;return T.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.value,r(a);case 2:case"end":return e.stop()}}))},onKeyPress:function(t){"Enter"===t.key&&e.history.push({pathname:"/search",search:"?q=".concat(n.trim().replace(/\s+/g,"+")),state:{query:n}})}}),c.a.createElement(M.a,{attached:"right",primary:!0,as:v.b,to:{pathname:"/search",search:"?q=".concat(n.trim().replace(/\s+/g,"+")),state:{query:n}}},"Search"))))))},H=a(195),Y=a.n(H),V=a(851),z=a(845),W=function(e){var t=e.apiState,a=e.showLoader,n=void 0===a||a,i=e.children;if(t.isError)throw t.error instanceof Error?t.error:new Error(t.error);return t.isLoading?c.a.createElement(z.a,{active:n}):t.data?c.a.createElement(r.Fragment,null,i):null},Q=a(856),G=a(43),J=a.n(G),K=function(e){return J.a.utc(e).format("MMMM D, YYYY h:mm A")},Z=Object(w.a)(Q.a)({boxShadow:"none !important"}),$=Object(w.a)(Q.a.Content)({padding:"0 !important"}),X=function(e){var t=e.name,a=e.date,n=e.description,r=e.link,i=e.query;return c.a.createElement(Z,{fluid:!0},c.a.createElement($,null,c.a.createElement(Q.a.Header,null,c.a.createElement(v.b,{to:function(){var e=i?i.trim().replace(/\s+/g," "):"";return{pathname:r,search:e?"?q=".concat(e.replace(/\s+/g,"+")):"",state:{query:e}}}()},t)),c.a.createElement(Q.a.Meta,null,K(a)),c.a.createElement(Q.a.Description,null,n)))},ee=c.a.memo((function(e){var t=e.events,a=e.query;return c.a.createElement(Q.a.Group,{centered:!0},t.map((function(e){var t=e.name,n=e.date,r=e.description,i=e.id;return c.a.createElement(X,{key:i,name:t,date:n,description:r,link:"/events/".concat(i),query:a})})))})),te=a(853),ae=a(73),ne=w.a.div({display:"flex",justifyContent:"space-between",padding:"1em 0"}),re=Object(w.a)(te.a)({minWidth:"250px !important",maxWidth:"90% !important",boxShadow:"none !important","@media(max-width:500px)":{width:"86% !important"}}),ce=Object(w.a)(te.a.Content)({flexGrow:"1",overflowY:"auto !important"}),ie=w.a.div({maxHeight:"45vh",display:"flex",flexDirection:"column"}),oe=c.a.memo((function(e){var t=e.filter,a=e.header,n=e.handlePopupClose,r=e.mountNodeRef,i=e.children,o=t.clear,l=t.getTextRep,u=t.isActive,s=c.a.useState(!1),m=Object(D.a)(s,2),d=m[0],p=m[1],f=function(){p(!1),n()};return c.a.createElement(re,{basic:!0,flowing:!0,mountNode:r.current,on:"click",onClose:f,onOpen:function(){p(!0)},open:d,pinned:!0,offset:"0, -5px",position:"bottom left",positionFixed:!0,trigger:c.a.createElement(M.a,{icon:!0,labelPosition:"right",basic:!u()},c.a.createElement(ae.a,{name:"angle down"}),l())},c.a.createElement(ie,null,c.a.createElement(k.a,{content:a}),c.a.createElement(ce,null,i),c.a.createElement(ne,null,c.a.createElement(M.a,{size:"mini",onClick:function(){o()}},c.a.createElement(ae.a,{name:"remove"})," Clear"),c.a.createElement(M.a,{size:"mini",primary:!0,onClick:f},c.a.createElement(ae.a,{name:"checkmark"})," Save"))))})),le=function(e,t){var a=J.a.utc(e.start,"YYYY-MM-DD"),n=J.a.utc(e.end,"YYYY-MM-DD"),r=a.format("MMM D, YYYY"),c=n.format("MMM D, YYYY");return e.start&&e.end?a.year()===n.year()&&a.month()===n.month()?"".concat(r.split(",")[0]," - ").concat(n.date(),", ").concat(n.year()):a.year()===n.year()?"".concat(r.split(",")[0]," - ").concat(c.split(",")[0],", ").concat(n.year()):"".concat(r," - ").concat(c):e.start?"".concat(r," -"):e.end?"- ".concat(c):t},ue=c.a.memo((function(e){var t=e.filter,a=t.value,n=t.handleChange,r=function(e,t){var a=t.name,r=t.value;n(a,r)};return c.a.createElement(V.a,null,c.a.createElement(V.a.Field,null,"From"),c.a.createElement(V.a.Input,{fluid:!0,name:"start",type:"date",onChange:r,value:a.start}),c.a.createElement(V.a.Field,null,"To"),c.a.createElement(V.a.Input,{fluid:!0,name:"end",type:"date",onChange:r,value:a.end}))})),se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return-1!==e.toLowerCase().indexOf(t.toLowerCase())},me=function(e,t){var a=Object.values(e).filter((function(e){return e})).length;return a?"".concat(t," : ").concat(a):t},de=Object(w.a)(V.a.Input)({paddingRight:".8em"}),pe=c.a.memo((function(e){var t=e.filter,a=e.options,n=e.optionQuery,r=e.setOptionQuery,i=t.filterName,o=t.value,l=t.handleChange,u=function(e,t){var a=t.name,n=t.checked;l(a,n)},s=a;return a.length>5&&(s=a.filter((function(e){var t=e.text;return se(t,n)}))),c.a.createElement(V.a,null,a.length>5&&c.a.createElement(de,{placeholder:"Search ".concat(i," Options"),value:n,onChange:function(e,t){var a=t.value;r(a)}}),s.map((function(e){return c.a.createElement(V.a.Checkbox,{key:e.name,label:e.text,name:e.name,checked:o[e.name],onChange:u})})))})),fe=a(847),he={date:"Most recent",value:"Most relevant"},ve=function(e,t){var a=t;return e.by&&e.by in he&&(a=he[e.by]),a},Ee=c.a.memo((function(e){var t=e.filter,a=e.sortByOptions,n=t.value,r=t.handleChange,i=function(e,t){var a=t.name,n=t.value;r(a,n)};return c.a.createElement(V.a,null,a.map((function(e){return c.a.createElement(V.a.Field,{checked:n.by===e,control:fe.a,id:"form-checkbox-control-".concat(e),key:e,label:he[e],name:"by",onChange:i,radio:!0,value:e})})))})),be=c.a.memo((function(e){var t=e.allBodies,a=e.filters,n=e.handlePopupClose,r=e.sortByOptions,i=c.a.useRef(),o=Object(D.a)(a,3),l=o[0],u=o[1],s=o[2],m=c.a.useState(""),d=Object(D.a)(m,2),p=d[0],f=d[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(oe,{filter:l,header:"Select Committees",handlePopupClose:n,mountNodeRef:i},c.a.createElement(pe,{filter:l,options:t.map((function(e){return{name:e.id,text:e.name}})),optionQuery:p,setOptionQuery:f})),c.a.createElement(oe,{filter:u,header:"Select Date Range",handlePopupClose:n,mountNodeRef:i},c.a.createElement(ue,{filter:u})),r&&c.a.createElement(oe,{filter:s,header:"Sort Results By",handlePopupClose:n,mountNodeRef:i},c.a.createElement(Ee,{filter:s,sortByOptions:r})),c.a.createElement("div",{ref:i}))})),ye=a(122),we=a(100),ge=a.n(we),xe=(a(833),a(435)),Oe=a.n(xe),je=a(41),ke=a.n(je);a(702);function Ce(e){return T.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(e).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}))}var Se={eq:"==",contains:"array-contains",contains_any:"array-contains-any",in:"in",gt:">",lt:"<",gteq:">=",lteq:"<="},_e={asc:"asc",desc:"desc"},Ae=function e(t){Object(u.a)(this,e);var a=new Error("Unsure how to create WhereCondition from received data: ".concat(t));if(t instanceof Array)if(2===t.length)this.columnName=t[0],this.operator=Se.eq,this.value=t[1];else{if(3!==t.length)throw a;if(!Object.values(Se).includes(t[1]))throw new Error("\n                        Unknown WhereCondition operator: ".concat(t[1],"\n                        Allowed WhereCondition operators: ").concat(Object.values(Se),"\n                    "));this.columnName=t[0],this.operator=t[1],this.value=t[2]}else{if(!(t instanceof Object))throw a;if(t.columnName&&t.operator&&t.value){if(!Object.values(Se).includes(t.operator))throw new Error("\n                        Unknown WhereCondition operator: ".concat(t.operator,"\n                        Allowed WhereCondition operators: ").concat(Object.values(Se),"\n                    "));this.columnName=t.columnName,this.operator=t.operator,this.value=t.value}else{if(!t.columnName||!t.value)throw a;this.columnName=t.columnName,this.operator=Se.eq,this.value=t.value}}},Ie=function e(t){Object(u.a)(this,e);var a,n=new Error("Unsure how to create OrderCondition from received data: ".concat(t));if("string"===typeof(a=t)||a instanceof String)this.columnName=t,this.operator=_e.desc;else if(t instanceof Array)if(1===t.length)this.columnName=t[0],this.operator=_e.desc;else{if(2!==t.length)throw n;if(!Object.values(_e).includes(t[1]))throw new Error("\n                        Unknown OrderCondition operator: ".concat(t[1],"\n                        Allowed OrderCondition operators: ").concat(Object.values(_e),"\n                    "));this.columnName=t[0],this.operator=t[1]}else{if(!(t instanceof Object))throw n;if(t.columnName&&t.operator){if(!Object.values(_e).includes(t.operator))throw new Error("\n                        Unknown OrderCondition operator: ".concat(t.operator,"\n                        Allowed OrderCondition operators: ").concat(Object.values(_e),"\n                    "));this.columnName=t.columnName,this.operator=t.operator}else{if(!t.columnName)throw n;this.columnName=t.columnName,this.operator=_e.desc}}},Pe=new(function(){function e(t){Object(u.a)(this,e),this.credentials=t,ge.a.initializeApp(this.credentials),this.connection=ge.a.firestore()}return Object(s.a)(e,[{key:"selectRowById",value:function(e,t){var a;return T.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T.a.awrap(this.connection.collection(e).doc(t).get());case 3:if((a=n.sent).exists){n.next=6;break}throw new Error("".concat(e," ").concat(t," doesn't exist."));case 6:return n.abrupt("return",a.data());case 9:return n.prev=9,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 12:case 13:case"end":return n.stop()}}),null,this,[[0,9]])}},{key:"_unpackQueryResults",value:function(e){var t;return T.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=[],e.forEach((function(e){var a=e.data(),n=Object(f.a)({id:e.id},a);t.push(n)})),a.abrupt("return",t);case 3:case"end":return a.stop()}}))}},{key:"selectRowsAsArray",value:function(e){var t,a,n,r,c,i=arguments;return T.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:[],a=i.length>2&&void 0!==i[2]?i[2]:void 0,n=i.length>3&&void 0!==i[3]?i[3]:1e3,o.prev=3,r=this.connection.collection(e),t.forEach((function(e){r=r.where(e.columnName,e.operator,e.value)})),a&&(r=r.orderBy(a.columnName,a.operator)),r=r.limit(n),o.next=11,T.a.awrap(r.get().catch((function(e){throw new Error("Failed to retrieve data from database. Error: ".concat(e))})));case 11:return c=o.sent,o.next=14,T.a.awrap(this._unpackQueryResults(c));case 14:return o.abrupt("return",o.sent);case 17:return o.prev=17,o.t0=o.catch(3),o.abrupt("return",Promise.reject(o.t0));case 20:case 21:case"end":return o.stop()}}),null,this,[[3,17]])}}]),e}())({apiKey:"AIzaSyA7aO6weBcOUBZLmxE3aMyn4NeElVEHZUc",authDomain:"cdp-sea.firebaseapp.com",projectId:"cdp-seattle",databaseURL:"https://cdp-sea.firebaseio.com"}),Re=ge.a.storage();function Te(){var e,t,a,n=arguments;return T.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:null,t=n.length>1&&void 0!==n[1]?n[1]:null,a=n.length>2&&void 0!==n[2]?n[2]:null,e||t||a){r.next=9;break}return r.next=6,T.a.awrap(De());case 6:return r.abrupt("return",r.sent);case 9:return r.next=11,T.a.awrap(ze(e,t,a));case 11:return r.abrupt("return",r.sent);case 12:case"end":return r.stop()}}))}function De(){var e;return T.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.a.awrap(Pe.selectRowsAsArray("event",[],new Ie(["event_datetime",_e.desc])));case 3:return e=t.sent,t.next=6,T.a.awrap(Qe(e));case 6:return t.abrupt("return",t.sent);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 12:case"end":return t.stop()}}),null,null,[[0,9]])}function Be(e,t){var a;return T.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T.a.awrap(Pe.selectRowsAsArray("event_minutes_item",[new Ae(["event_id",Se.eq,e])],new Ie(["index",t])));case 3:return a=n.sent,n.abrupt("return",a);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 10:case 11:case"end":return n.stop()}}),null,null,[[0,7]])}function Me(e){var t,a;return T.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T.a.awrap(Pe.selectRowById("minutes_item",e.minutes_item_id));case 3:return t=n.sent,n.next=6,T.a.awrap(Pe.selectRowsAsArray("minutes_item_file",[new Ae(["minutes_item_id",Se.eq,e.minutes_item_id])],new Ie(["name",_e.asc])));case 6:return a=n.sent,n.abrupt("return",Object(f.a)({},e,{minutes_item:Object(f.a)({id:e.minutes_item_id},t,{file:a})}));case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 13:case 14:case"end":return n.stop()}}),null,null,[[0,10]])}function Fe(e){var t;return T.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,T.a.awrap(Pe.selectRowById("body",e));case 3:return t=a.sent,a.abrupt("return",t);case 7:return a.prev=7,a.t0=a.catch(0),a.abrupt("return",Promise.reject(a.t0));case 10:case"end":return a.stop()}}),null,null,[[0,7]])}function Le(e){var t,a;return T.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T.a.awrap(Ne(e));case 3:return t=n.sent,n.next=6,T.a.awrap(Ue(t.file_id,Ce));case 6:return a=n.sent,n.abrupt("return",a);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 13:case"end":return n.stop()}}),null,null,[[0,10]])}function Ne(e){var t,a,n;return T.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,T.a.awrap(Pe.selectRowsAsArray("transcript",[new Ae(["event_id",Se.eq,e])],null,1));case 2:if(t=r.sent,a=Object(D.a)(t,1),n=a[0]){r.next=7;break}throw new Error("Transcript doesn't exist for event: ".concat(e));case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}}))}function Ue(e,t){var a,n,r;return T.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,T.a.awrap(Pe.selectRowById("file",e));case 2:return a=c.sent,n=Re.refFromURL(a.uri),c.next=6,T.a.awrap(n.getDownloadURL().then((function(e){return t(e)})));case 6:if(r=c.sent){c.next=9;break}throw new Error("Failed to download ".concat(a.filename," from ").concat(a.uri,"."));case 9:return c.abrupt("return",r);case 10:case"end":return c.stop()}}))}function qe(e){var t,a,n,r,c;return T.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.filter((function(e){return null!==e.decision})),a=[],t.forEach((function(e){a.push({matter:e.minutes_item.matter,name:e.minutes_item.name,id:e.id,decision:e.decision,index:e.index})})),n=a.map((function(e){return Pe.selectRowsAsArray("vote",[new Ae(["event_minutes_item_id",Se.eq,e.id])])})),i.next=7,T.a.awrap(Promise.all(n));case 7:return r=i.sent,i.next=10,T.a.awrap(Pe.selectRowsAsArray("person"));case 10:return c=i.sent,a.forEach((function(e,t){var a=r[t],n=[];a.forEach((function(e){var t=c.find((function(t){return t.id===e.person_id}));n.push({decision:e.decision,person_id:e.person_id,full_name:t.full_name})})),e.formattedIndividualVotes=Object(je.sortBy)(n,(function(e){return e.full_name}))})),i.abrupt("return",a);case 15:return i.prev=15,i.t0=i.catch(0),i.abrupt("return",Promise.reject(i.t0));case 18:case"end":return i.stop()}}),null,null,[[0,15]])}function He(e){var t,a,n,r,c,i;return T.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,T.a.awrap(Pe.selectRowById("event",e));case 3:return t=o.sent,o.next=6,T.a.awrap(Fe(t.body_id));case 6:return a=o.sent,o.next=9,T.a.awrap(Be(e,_e.asc));case 9:return n=o.sent,o.next=12,T.a.awrap(Promise.all(n.map((function(e){return Me(e)}))));case 12:return r=o.sent,o.next=15,T.a.awrap(Le(e));case 15:return c=o.sent,o.next=18,T.a.awrap(qe(r));case 18:return i=o.sent,o.abrupt("return",{id:e,name:a.name,description:a.description,videoUrl:t.video_uri,date:J.a.utc(t.event_datetime.toMillis()).toISOString(),minutes:r,transcript:c,scPageUrl:t.source_uri,votes:i});case 22:return o.prev=22,o.t0=o.catch(0),o.abrupt("return",Promise.reject(o.t0));case 25:case"end":return o.stop()}}),null,null,[[0,22]])}function Ye(e){var t,a,n,r,c,i,o,l,u,s=arguments;return T.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(t=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:[],n=s.length>3&&void 0!==s[3]?s[3]:{},r=0,m.prev=4,Oe.a.PorterStemmer.attach(),0!==(c=e.tokenizeAndStem()).length){m.next=9;break}return m.abrupt("return",[]);case 9:return m.next=11,T.a.awrap(Promise.all(c.map((function(e){return Pe.selectRowsAsArray("indexed_event_term",[new Ae(["term",Se.eq,e])])}))));case 11:return i=m.sent,o=Object(je.mapValues)(Object(je.groupBy)(Object(je.flatten)(i),(function(e){return e.event_id})),(function(e,t){return e.reduce((function(e,t){return Object(f.a)({},e,{value:e.value+t.value})}),{event_id:t,value:0})})),l=Object(je.filter)(o,(function(e){return e.value>r})),m.next=16,T.a.awrap(Promise.all(l.map((function(e){var t=e.event_id;return Pe.selectRowById("event",t)}))));case 16:return u=m.sent,m.next=19,T.a.awrap(Qe(u));case 19:return(u=m.sent).forEach((function(e,t){e.id=l[t].event_id,e.value=l[t].value})),u=Je(u=Ge(u,t,a),n,!0),m.abrupt("return",u);case 26:return m.prev=26,m.t0=m.catch(4),m.abrupt("return",Promise.reject(m.t0));case 29:case"end":return m.stop()}}),null,null,[[4,26]])}function Ve(){return T.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",Pe.selectRowsAsArray("body",[],new Ie(["name",_e.asc])));case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 7:case"end":return e.stop()}}),null,null,[[0,4]])}function ze(e,t,a){var n,r;return T.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,n=[],t.length?t.forEach((function(t){return n.push(We(e,t))})):n.push(We(e)),c.t0=je.flatten,c.next=6,T.a.awrap(Promise.all(n));case 6:return c.t1=c.sent,r=(0,c.t0)(c.t1),c.next=10,T.a.awrap(Qe(r));case 10:return r=Je(r=c.sent,a),c.abrupt("return",r);case 15:return c.prev=15,c.t2=c.catch(0),c.abrupt("return",Promise.reject(c.t2));case 18:case"end":return c.stop()}}),null,null,[[0,15]])}function We(e){var t,a,n,r,c,i,o=arguments;return T.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:null,a=[],t&&a.push(new Ae(["body_id",Se.eq,t])),e.start&&(n=J.a.utc(e.start,"YYYY-MM-DD"),r=ge.a.firestore.Timestamp.fromMillis(n.valueOf()),a.push(new Ae(["event_datetime",Se.gteq,r]))),e.end&&(c=J.a.utc(e.end,"YYYY-MM-DD").add(1,"days").subtract(1,"milliseconds"),i=ge.a.firestore.Timestamp.fromMillis(c.valueOf()),a.push(new Ae(["event_datetime",Se.lteq,i]))),l.abrupt("return",Pe.selectRowsAsArray("event",a));case 6:case"end":return l.stop()}}))}function Qe(e){var t;return T.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,T.a.awrap(Ve());case 2:return t=a.sent,a.abrupt("return",e.map((function(e){var a=t.find((function(t){return t.id===e.body_id}));return{id:e.id,body_id:a.id,name:a.name,description:a.description,date:J.a.utc(e.event_datetime.toMillis()).toISOString()}})));case 4:case"end":return a.stop()}}))}function Ge(e,t,a){return e.filter((function(e){if(a.length&&-1===a.indexOf(e.body_id))return!1;if(t.start&&J.a.utc(e.date).isBefore(J.a.utc(t.start)))return!1;if(t.end){var n=J.a.utc(t.end,"YYYY-MM-DD").add(1,"days").subtract(1,"milliseconds");if(J.a.utc(e.date).isAfter(n))return!1}return!0}))}function Je(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=t.by&&t.order?Object(je.orderBy)(e,[t.by],[t.order]):Object(je.orderBy)(e,[a?"value":"date"],[_e.desc])}function Ke(){var e;return T.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.a.awrap(Pe.selectRowsAsArray("person",[],new Ie(["full_name",_e.asc])));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 10:case"end":return t.stop()}}),null,null,[[0,7]])}function Ze(e){var t,a,n,r,c,i,o,l,u,s,m;return T.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,t=[],d.next=4,T.a.awrap(Pe.selectRowById("person",e));case 4:return a=d.sent,d.next=7,T.a.awrap(Pe.selectRowsAsArray("vote",[new Ae(["person_id",Se.eq,e])]));case 7:return n=d.sent,r=n.map((function(e){return Pe.selectRowById("event_minutes_item",e.event_minutes_item_id)})),d.next=11,T.a.awrap(Promise.all(r));case 11:return c=d.sent,i=c.map((function(e){return Pe.selectRowById("minutes_item",e.minutes_item_id)})),d.next=15,T.a.awrap(Promise.all(i));case 15:return o=d.sent,l=c.map((function(e){return Pe.selectRowById("event",e.event_id)})),d.next=19,T.a.awrap(Promise.all(l));case 19:return u=d.sent,d.next=22,T.a.awrap(Pe.selectRowsAsArray("body"));case 22:return s=d.sent,n.forEach((function(e,a){var n=c[a],r=o[a],i=u[a],l=s.find((function(e){return e.id===i.body_id})),m={id:e.id,matter:r.matter,name:r.name,voteForPerson:e.decision,decision:n.decision,eventId:n.event_id,index:n.index,eventDate:J.a.utc(i.event_datetime.toMillis()).toISOString(),body_name:l.name};t.push(m)})),m=Object(je.orderBy)(t,["eventDate","index"],["desc","desc"]),d.abrupt("return",Object(f.a)({},a,{votes:m}));case 28:return d.prev=28,d.t0=d.catch(0),d.abrupt("return",Promise.reject(d.t0));case 31:case"end":return d.stop()}}),null,null,[[0,28]])}var $e=function(e,t){switch(t.type){case"FETCH_INIT":return Object(f.a)({},e,{isLoading:!0,isError:!1});case"FETCH_SUCCESS":return Object(f.a)({},e,{isLoading:!1,isError:!1,data:t.payload.data});case"FETCH_FAILURE":return Object(f.a)({},e,{isLoading:!1,isError:!0,error:t.payload.error});default:return e}},Xe=function(e,t,a){var c=Object(r.useState)(t),i=Object(D.a)(c,2),o=i[0],l=i[1],u=Object(r.useReducer)($e,{isLoading:!1,isError:!1,error:null,data:a}),s=Object(D.a)(u,2),m=s[0],d=s[1];return Object(r.useEffect)((function(){var t=!1;return function(){var a;T.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(d({type:"FETCH_INIT"}),r.prev=1,!o){r.next=8;break}return r.next=5,T.a.awrap(n[e].apply(n,Object(ye.a)(o)));case 5:a=r.sent,r.next=11;break;case 8:return r.next=10,T.a.awrap(n[e]());case 10:a=r.sent;case 11:t||d({type:"FETCH_SUCCESS",payload:{data:a}}),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(1),t||d({type:"FETCH_FAILURE",payload:{error:r.t0}});case 17:case"end":return r.stop()}}),null,null,[[1,14]])}(),function(){t=!0}}),[e,o]),[m,l]},et=function(e){var t=e.filters,a=e.handlePopupClose,n=e.sortByOptions,r=Xe("getAllBodies",null,null),i=Object(D.a)(r,1)[0];return c.a.createElement(W,{showLoader:!1,apiState:i},c.a.createElement(be,{allBodies:i.data,filters:t,handlePopupClose:a,sortByOptions:n}))};var tt=function(e){c.a.useEffect((function(){return document.title=e,function(){document.title="Council Data Project - Seattle"}}),[e])},at=a(193);function nt(e){return Object.keys(e).filter((function(t){return e[t]}))}var rt=function(e,t,a,n){var r=c.a.useState(e),i=Object(D.a)(r,2),o=i[0],l=i[1],u=function(){return Object.values(o).some((function(e){return e!==a}))};return{filterName:t,value:o,set:l,clear:function(){l((function(e){var t=Object(f.a)({},e);return Object.keys(t).forEach((function(e){return t[e]=a})),t}))},handleChange:function(e,t){l((function(a){return Object(f.a)({},a,Object(at.a)({},e,t))}))},getTextRep:function(){return n(o,t)},isActive:u,isSameValue:function(e){if(!e)return!u();for(var t,a=0,n=Object.keys(o);a<n.length;a++){if(t=n[a],o[t]&&!e.hasOwnProperty(t))return!1;if(o[t]!==e[t]&&e.hasOwnProperty(t))return!1}return!0}}},ct=w.a.div({position:"sticky",top:"0",backgroundColor:"white",zIndex:"1",padding:"1em 0 2em","> .ui.button":{marginBottom:"0.5em","@media(max-width:500px)":{width:"100%"}}}),it=w.a.span({display:"block",color:"grey",marginBottom:"2em"}),ot=w.a.div({paddingLeft:"1em"}),lt=function(e){e.query;var t=rt({start:"",end:""},"Date","",le),a=rt({},"Committee",!1,me),n=rt({by:"",order:""},"Sort","",ve),r=Xe("getEvents",null,null),i=Object(D.a)(r,2),o=i[0],l=i[1];tt("Committee Events");var u=c.a.useRef(),s=c.a.useRef(),m=c.a.useRef();return c.a.createElement(c.a.Fragment,null,c.a.createElement(ct,null,c.a.createElement(et,{filters:[a,t],handlePopupClose:function(){return T.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.isSameValue(u.current)&&t.isSameValue(s.current)&&n.isSameValue(m.current)||(window.scroll(0,0),l((function(){var e=[t.value,nt(a.value),n.value];return u.current=a.value,s.current=t.value,m.current=n.value,e})));case 1:case"end":return e.stop()}}))}})),c.a.createElement(ot,null,c.a.createElement(W,{apiState:o},o.data&&c.a.createElement(it,null,o.data.length," results"),c.a.createElement(ee,{events:o.data}))))},ut=function(e){var t=e.query,a=c.a.useState(t),n=Object(D.a)(a,2),r=n[0],i=n[1],o=rt({start:"",end:""},"Date","",le),l=rt({},"Committee",!1,me),u=rt({by:"value"},"Sort By","",ve),s=Xe("getEventsByIndexedTerm",[t,o.value,nt(l.value),u.value],null),m=Object(D.a)(s,2),d=m[0],p=m[1];tt("Search - ".concat(r));var f=Object(E.f)(),h=c.a.useRef(),v=c.a.useRef(),b=c.a.useRef(),y=c.a.useRef(t),w=function(){l.isSameValue(h.current)&&o.isSameValue(v.current)&&u.isSameValue(b.current)&&y.current===r||(window.scroll(0,0),p((function(){var e=[r,o.value,nt(l.value),u.value];return h.current=l.value,v.current=o.value,b.current=u.value,y.current=r,e})),f.replace({pathname:"/search",search:"?q=".concat(r.trim().replace(/\s+/g,"+"))}))};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ct,null,c.a.createElement(V.a,{onSubmit:function(e){e.preventDefault(),w()}},c.a.createElement(V.a.Group,{widths:"2"},c.a.createElement(V.a.Input,{placeholder:"Enter a keyword to search meeting transcripts",action:c.a.createElement(M.a,{type:"submit",primary:!0},"Search"),value:r,onChange:function(e,t){var a=t.value;i(a)}}))),c.a.createElement(et,{filters:[l,o,u],handlePopupClose:w,sortByOptions:["value","date"]})),c.a.createElement(ot,null,c.a.createElement(W,{apiState:d},d.data&&c.a.createElement(it,null,d.data.length," results"),c.a.createElement(ee,{events:d.data,query:y.current}))))},st=Object(w.a)(y.a)({minHeight:"100vh"}),mt=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),dt=function(e){var t=e.location,a=Y.a.parse(t.search).q,n=a?a.trim().replace(/\+/g," "):"";return c.a.createElement(st,null,c.a.createElement(mt,null,c.a.createElement(P,null,c.a.createElement(ut,{query:n}))))},pt=a(152),ft=a(440),ht=a.n(ft);var vt=function(e){e=parseInt(e,10);var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return t<10&&(t="0"+t),a<10&&(a="0"+a),n<10&&(n="0"+n),t+":"+a+":"+n},Et=w.a.div({margin:"1em 0.2em"}),bt=w.a.div({fontSize:"16px",lineHeight:"1.5em"}),yt=w.a.div({marginTop:"10px",".ui.button":{padding:"0.8em !important"}}),wt=c.a.memo((function(e){var t=e.searchText,a=e.transcript,n=e.handleSeek,r=new pt.c({fixedWidth:!0,defaultHeight:100}),i=function(e){var i=e.index,o=e.parent,l=e.key,u=e.style;return(c.a.createElement(pt.b,{key:l,cache:r,parent:o,columnIndex:0,rowIndex:i},c.a.createElement("div",{style:u},c.a.createElement(Et,null,c.a.createElement(bt,null,c.a.createElement(ht.a,{searchWords:[t],autoEscape:!0,textToHighlight:a[i].text})),c.a.createElement(yt,null,c.a.createElement(M.a,{size:"tiny",onClick:function(){return n(a[i].start_time)}},c.a.createElement(ae.a,{name:"play"}),vt(a[i].start_time)))))))};return c.a.createElement(pt.a,{onResize:function(){r.clearAll()}},(function(e){var t=e.width,n=e.height;return c.a.createElement(pt.d,{deferredMeasurementCache:r,height:n,rowCount:a.length,rowHeight:r.rowHeight,rowRenderer:i,scrollToIndex:0,style:{willChange:""},width:t})}))})),gt=w.a.div({margin:"1em 0",width:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box","@media (min-aspect-ratio:5/4), (min-width:1200px)":{width:"38%",margin:"0 0 0 20px"}}),xt=w.a.h2({width:"100%"}),Ot=Object(w.a)(B.a)({width:"100%",fontSize:"16px !important",lineHeight:"1.5 !important"}),jt=w.a.span({display:"block",marginTop:"1em",color:"grey",paddingLeft:"15px"}),kt=w.a.span({display:"block",marginTop:"1em",fontSize:"16px !important",lineHeight:"1.5 !important",paddingLeft:"15px"}),Ct=w.a.div({marginTop:"1em",border:"1px solid lightgray",borderRadius:"0.28rem",boxSizing:"border-box",minHeight:"calc(.5625 * 90vw)","@media (min-aspect-ratio:5/4), (min-width:1200px)":{flex:"1 1 auto",minHeight:"0"}}),St=function(e){var t=e.transcript,a=e.handleSeek,n=e.query,r=c.a.useState(n),i=Object(D.a)(r,2),o=i[0],l=i[1],u=t.filter((function(e){var t=e.text;return se(t,o)}));return c.a.createElement(gt,null,c.a.createElement(xt,null,"Search Transcript"),c.a.createElement(Ot,{onChange:function(e,t){var a=t.value;l(a)},value:o,placeholder:"Search transcript"}),""!==o&&c.a.createElement(jt,null,u.length," results"),""!==o&&u.length>0&&c.a.createElement(Ct,null,c.a.createElement(wt,{searchText:o,transcript:u,handleSeek:a})),""===o&&c.a.createElement(kt,null,"Enter a search term to get results."))},_t=a(852),At=a(269),It=Object(w.a)(B.a)((function(e){return{borderBottomColor:e.disabled?"white":"black",borderBottomStyle:"solid",borderBottomWidth:"1.5px",width:"10em"}})),Pt=Object(w.a)(_t.a)({"i.close":{top:"0 !important",right:"0 !important",color:"black !important"}}),Rt=Object(r.forwardRef)((function(e,t){return c.a.createElement(At.a,{innerRef:t},c.a.createElement(M.a,e))})),Tt=Object(w.a)(Rt)({backgroundColor:"white !important","i.share":{paddingRight:"1.5em"}}),Dt=w.a.div({display:"inline-block"}),Bt=function(e){var t=e.trim().split(":").reverse(),a=0;return t.forEach((function(e,t){(e=e.trim())&&(isNaN(e)||e.includes("-")?a+=NaN:a+=parseFloat(e)*Math.pow(60,t))})),a&&(a=Math.floor(a)),a},Mt=function(e){if(isNaN(e))return"INVALID TIME POINT";e=Math.floor(parseFloat(e));var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;n<10&&(n="0".concat(n)),t>0&&a<10&&(a="0".concat(a));var r="".concat(a,":").concat(n);return t&&(r="".concat(t,":").concat(r)),r},Ft={value:"",isDisabled:!1,isActive:!1},Lt=function(e,t){switch(t.type){case"UPDATE_VALUE":return Object(f.a)({},e,{value:t.payload.value});case"VALIDATE_VALUE":var a=Mt(Bt(e.value));return Object(f.a)({},e,{value:a});case"UPDATE_ISDISABLED":return Object(f.a)({},e,{isDisabled:t.payload.isDisabled});case"UPDATE_ISACTIVE":return Object(f.a)({},e,{isActive:t.payload.isActive});default:return e}},Nt=function(e){var t=e.videoPlayerRef,a=Object(r.useRef)(),n=Object(r.useRef)(),i=Object(r.useRef)(),o=Object(E.g)(),l=Object(r.useState)(!1),u=Object(D.a)(l,2),s=u[0],m=u[1],d=Object(r.useReducer)(Lt,Ft),p=Object(D.a)(d,2),f=p[0],h=p[1],v=function(){h({type:"VALIDATE_VALUE"})};return c.a.createElement(r.Fragment,null,c.a.createElement(Pt,{closeIcon:!0,trigger:c.a.createElement(Tt,{compact:!0,icon:!0,onClick:function(){var e;if(t.current){var a=t.current.getState().player;e=4===a.readyState?a.currentTime:0}else e=0;h({type:"UPDATE_VALUE",payload:{value:Mt(e)}}),h({type:"UPDATE_ISDISABLED",payload:{isDisabled:!1}}),h({type:"UPDATE_ISACTIVE",payload:{isActive:!1}}),m(!0)}},c.a.createElement(ae.a,{name:"share"}),"SHARE"),open:s,onClose:function(){i.current.inputRef.current.removeEventListener("blur",v),m(!1)},mountNode:a.current,onMount:function(){i.current.inputRef.current.addEventListener("blur",v)},size:"small"},c.a.createElement(_t.a.Header,null,"Share"),c.a.createElement(_t.a.Content,null,c.a.createElement(B.a,{fluid:!0,action:c.a.createElement(M.a,{primary:!0,content:"Copy",onClick:function(){n.current.select(),document.execCommand("copy")}}),ref:n,value:function(){var e=Bt(f.value),t="".concat(document.location.href.split("#")[0],"#").concat(o.pathname);return f.isActive&&e?"".concat(t,"?t=").concat(e):"".concat(t)}()}),c.a.createElement("br",null),c.a.createElement(V.a,{onSubmit:v},c.a.createElement(V.a.Group,null,c.a.createElement(V.a.Checkbox,{label:"Start at",checked:f.isActive,onChange:function(e,t){var a=t.checked;h({type:"VALIDATE_VALUE"}),h({type:"UPDATE_ISDISABLED",payload:{isDisabled:!a}}),h({type:"UPDATE_ISACTIVE",payload:{isActive:a}})}}),c.a.createElement(It,{disabled:f.isDisabled,transparent:!0,value:f.value,onChange:function(e,t){var a=t.value;h({type:"UPDATE_VALUE",payload:{value:a}})},ref:i}))))),c.a.createElement(Dt,{ref:a}))},Ut=a(857),qt=a(849),Ht=w.a.ol({listStylePosition:"outside",paddingLeft:"1.5em"}),Yt=w.a.div({fontSize:"1em",fontWeight:"500"}),Vt=w.a.div({fontSize:"0.95em"}),zt=w.a.ul({listStylePosition:"outside",listStyleType:"disc",paddingLeft:"2em"}),Wt=function(e){var t=e.minutes,a=e.scPageUrl;return c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",null,"Minutes"),c.a.createElement(Ht,null,t.map((function(e){var t=e.minutes_item;return c.a.createElement("li",{key:t.id},c.a.createElement(Yt,null,t.matter?t.matter:t.name),t.matter&&t.matter!==t.name&&c.a.createElement(Vt,null,t.name),t.file.length>0&&c.a.createElement(zt,null,t.file.map((function(e){var t=e.id,a=e.name,n=e.uri;return c.a.createElement("li",{key:t},c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},a))}))))}))),c.a.createElement("h3",null,"Links"),c.a.createElement("a",{href:a},"Seattle Channel Event Page"))},Qt=a(848),Gt=w.a.div((function(e){return{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",margin:e.isSpeakerTurnFormat?"2.5em 0.2em":"3em 0.2em"}})),Jt=w.a.div({width:"100%",fontSize:"16px",lineHeight:"1.5em","@media(min-width:1000px)":{width:"85%",order:"1"}}),Kt=w.a.div({width:"100%",marginTop:"10px","@media(min-width:1000px)":{width:"15%",order:"0",marginTop:"0"}}),Zt=c.a.memo((function(e){var t=e.handleSeek,a=e.transcript,n=[];return a.format.includes("speaker-turns")?a.data.forEach((function(e){var t;e.data[0].speaker=e.speaker||"New Speaker",(t=n).push.apply(t,Object(ye.a)(e.data))})):n=a.data,c.a.createElement("div",null,n.map((function(e){return function(e,t,a){return c.a.createElement("div",{key:e.start_time},!!e.speaker&&c.a.createElement(Qt.a,{horizontal:!0},c.a.createElement(k.a,{as:"h3"},e.speaker)),c.a.createElement(Gt,{isSpeakerTurnFormat:t},c.a.createElement(Jt,null,e.text),c.a.createElement(Kt,null,c.a.createElement(M.a,{size:"tiny",onClick:function(){return a(e.start_time)}},c.a.createElement(ae.a,{name:"play"}),vt(e.start_time)))))}(e,a.format.includes("speaker-turns"),t)})))})),$t=a(855),Xt=[{accessor:"matter",text:"Matter",width:"2"},{accessor:"decision",text:"Decision",width:"1"},{accessor:"name",text:"Name",width:"6"},{accessor:"votingRecords",text:"Vote",width:"5"}],ea=Object(w.a)("div")({display:"flex"}),ta=Object(w.a)("div")({width:"70%"}),aa=Object(w.a)("div")({width:"30%"}),na=Object(w.a)($t.a.Header)({"@media(max-width:767px)":{display:"none !important"}}),ra=function(e){var t=e.votingData,a=e.isPerson;return c.a.createElement($t.a,{striped:!0},c.a.createElement(na,null,c.a.createElement($t.a.Row,null,Xt.map((function(e){return c.a.createElement($t.a.HeaderCell,{key:e.text},e.text)})),a&&c.a.createElement($t.a.HeaderCell,{key:"Event"},"Event"))),c.a.createElement($t.a.Body,null,t.map((function(e){return c.a.createElement($t.a.Row,{key:e.id},Xt.map((function(t){return"votingRecords"!==t.accessor?c.a.createElement($t.a.Cell,{key:t.accessor,width:t.width},e[t.accessor]):e.formattedIndividualVotes?c.a.createElement($t.a.Cell,{key:t.accessor,width:t.width},e.formattedIndividualVotes.map((function(e){return c.a.createElement(ea,{key:e.full_name},c.a.createElement(ta,null,c.a.createElement(v.b,{to:"/people/".concat(e.person_id)},e.full_name)),c.a.createElement(aa,null,e.decision))}))):c.a.createElement(c.a.Fragment,{key:t.accessor},c.a.createElement($t.a.Cell,{singleLine:!0},e.voteForPerson),c.a.createElement($t.a.Cell,null,c.a.createElement(v.b,{to:"/events/".concat(e.eventId)},c.a.createElement("span",null,e.body_name)),c.a.createElement("div",null,K(e.eventDate))))})))}))))},ca=w.a.div({margin:"1em 0",width:"100%",fontSize:"16px",lineHeight:"1.5","a.item":{fontSize:"1.3em !important"}}),ia=Object(w.a)(Ut.a)({borderBottom:"0 !important",marginBottom:"1em !important",paddingTop:"1em !important",backgroundColor:"white !important",zIndex:"0 !important",width:"100%"}),oa=c.a.memo((function(e){var t=e.minutes,a=e.scPageUrl,n=e.transcript,r=e.votes,i=e.handleSeek,o=e.topOffset,l=e.mediaQueriesMatches,u=c.a.useState("details"),s=Object(D.a)(u,2),m=s[0],d=s[1],p=c.a.useRef(null),f=function(e,t){var a=t.name;p.current.getBoundingClientRect().top<0&&(p.current.scrollIntoView(!0),l||window.scrollBy(0,-o)),d(a)};return c.a.createElement(ca,{ref:p},c.a.createElement(qt.a,{context:p,offset:o,styleElement:{zIndex:"1"}},c.a.createElement(ia,{secondary:!0,pointing:!0},c.a.createElement(Ut.a.Item,{active:"details"===m,name:"details",onClick:f}),c.a.createElement(Ut.a.Item,{active:"transcript"===m,name:"transcript",onClick:f}),c.a.createElement(Ut.a.Item,{active:"votes"===m,name:"votes",onClick:f}))),{details:c.a.createElement(Wt,{minutes:t,scPageUrl:a}),transcript:c.a.createElement(Zt,{handleSeek:i,transcript:n}),votes:r.length?c.a.createElement(ra,{votingData:r}):c.a.createElement("div",null,"No votes found for this event.")}[m])})),la=a(850),ua=a(124);var sa=function(e){var t=Object(r.useState)((function(){return matchMedia(e).matches})),a=Object(D.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)((function(){var t=matchMedia(e),a=function(e){c(e.matches)};return t.addListener(a),function(){t.removeListener(a)}}),[e]),n},ma=(a(831),w.a.div({display:"flex",flexWrap:"wrap",justifyContent:"space-between"})),da=w.a.div({width:"100%",margin:"1em 0"}),pa=w.a.span({margin:"0.1em 0",color:"grey",fontWeight:"400"}),fa=Object(w.a)(b.a.Inline)({display:"flex",justifyContent:"space-between",width:"100%","@media (min-aspect-ratio:5/4), (min-width:1200px)":{width:"59%"}}),ha=w.a.div({position:"absolute",left:"0",right:"0",visibility:"hidden",height:"90px",backgroundColor:"yellow"}),va=w.a.div((function(e){return{position:"relative",display:"none","@media (min-aspect-ratio:5/4), (min-width:1200px)":{display:e.isFixed?"block":"none",width:"59%"}}})),Ea=w.a.div({position:"absolute",top:"0",left:"0",backgroundColor:"black",height:"100%",width:"100%"}),ba=w.a.button((function(e){return{position:"absolute",top:"5px",right:"5px",opacity:"0.5",borderRadius:"50%",zIndex:10,visibility:e.isFixed?"visible":"hidden","&:hover":{opacity:.9}}})),ya=w.a.div((function(e){return{width:"100%",position:"sticky",top:"0",zIndex:"2","@media (min-aspect-ratio:5/4), (min-width:1200px)":{position:e.isFixed?"fixed":"relative",width:e.isFixed?"20vw":"59%",right:"0"}}})),wa=w.a.div({position:"relative",paddingTop:"56.25%"}),ga=function(e){e.id;var t=e.eventData,a=e.query,n=e.videoTimePoint,r=t.name,i=t.date,o=t.minutes,l=t.scPageUrl,u=t.videoUrl,s=t.transcript,m=t.votes,d=c.a.useRef(null),p=c.a.useState(!1),f=Object(D.a)(p,2),h=f[0],v=f[1],E=sa("(min-aspect-ratio:5/4), (min-width:1200px)"),y=c.a.useState(0),w=Object(D.a)(y,2),g=w[0],x=w[1];c.a.useEffect((function(){var e=d.current.video.video;e.disablePictureInPicture=!0,x(e.offsetHeight)}),[]),c.a.useEffect((function(){var e=function(){var e=d.current.video.video;x(e.offsetHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var O=function(e){d.current.seek(parseFloat(e));var t=d.current.getState().player;!t.paused&&t.hasStarted||d.current.play()};return c.a.createElement(ma,null,c.a.createElement(da,null,c.a.createElement("h1",null,r)),c.a.createElement(fa,null,c.a.createElement(pa,null,K(i)),c.a.createElement(b.a.Inline,null,c.a.createElement(Nt,{videoPlayerRef:d}))),c.a.createElement(va,{isFixed:h},c.a.createElement(wa,null,c.a.createElement(Ea,null))),c.a.createElement(ya,{isFixed:h},c.a.createElement(ba,{onClick:function(){v(!1),d.current.pause()},isFixed:h},"x"),c.a.createElement(ua.Player,{fluid:!0,aspectRatio:"16:9",preload:n?"auto":"metadata",ref:d,src:u,startTime:n},c.a.createElement(ua.BigPlayButton,{position:"center"}),c.a.createElement(ua.ControlBar,{autoHide:!0},c.a.createElement(ua.VolumeMenuButton,{vertical:!0}),c.a.createElement(ua.PlaybackRateMenuButton,{rates:[2,1.5,1,.75],order:6.1})))),c.a.createElement(la.a,{once:!1,onBottomPassed:function(){E&&v(!0)},onBottomPassedReverse:function(){E&&v(!1)}},c.a.createElement(ha,null)),c.a.createElement(St,{transcript:function(){if(s.format.includes("speaker-turns")){var e=[];return s.data.forEach((function(t){e.push.apply(e,Object(ye.a)(t.data))})),e}return s.data}(),handleSeek:O,query:a}),c.a.createElement(oa,{minutes:o,scPageUrl:l,transcript:s,votes:m,handleSeek:O,topOffset:E?0:g,mediaQueriesMatches:E}))},xa=function(e){var t=e.id,a=e.query,n=e.videoTimePoint,r=Xe("getEventById",[t],null),i=Object(D.a)(r,1)[0];return tt(i.data?"".concat(i.data.name," - ").concat(K(i.data.date)):"Loading..."),c.a.createElement(W,{apiState:i},c.a.createElement(ga,{id:t,eventData:i.data,query:a,videoTimePoint:n}))},Oa=Object(w.a)(y.a)({minHeight:"100vh"}),ja=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),ka=function(e){var t=e.match,a=e.location,n=Y.a.parse(a.search),r=n.q,i=n.t;return c.a.createElement(Oa,null,c.a.createElement(ja,null,c.a.createElement(P,null,c.a.createElement(xa,{id:t.params.id,query:function(){var e=r?r.trim().replace(/\+/g," "):"";return a.state&&(e=a.state.query||e),e}(),videoTimePoint:!i||isNaN(i)?0:Math.max(0,parseFloat(i))}))))},Ca=Object(w.a)(y.a)({minHeight:"100vh"}),Sa=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),_a=function(){return c.a.createElement(Ca,null,c.a.createElement(Sa,null,c.a.createElement("h2",null,"All Events"),c.a.createElement(P,null,c.a.createElement(lt,null))))},Aa=Object(w.a)("div")({display:"flex",flexWrap:"wrap"}),Ia=Object(w.a)("div")({width:"250px",border:"1px solid #d4d4d5",boxShadow:"0 1px 3px 0 #d4d4d5",padding:"1.5rem",marginBottom:"1.5rem",borderRadius:"3px",marginRight:"2rem",cursor:"pointer",transition:".4s all",":hover":{transform:"scale(1.15)"}}),Pa=Object(w.a)("h5")({fontWeight:600,fontSize:"1.2rem"}),Ra=Object(E.h)((function(e){var t=e.people,a=e.history;return c.a.createElement(r.Fragment,null,c.a.createElement("h2",null,"City Council Members"),c.a.createElement(Aa,null,t.map((function(e){var t=e.full_name,n=e.email,r=e.id;return c.a.createElement(Ia,{key:t,onClick:function(){return a.push("/people/".concat(r))}},c.a.createElement(Pa,null,t),c.a.createElement("p",null,"City Council Member"),c.a.createElement("a",{href:"mailto:".concat(n)},n))}))))})),Ta=function(){var e=Xe("getAllPeople",null,null),t=Object(D.a)(e,1)[0];return tt("City Council Members"),c.a.createElement(W,{apiState:t},c.a.createElement(Ra,{people:t.data}))},Da=Object(w.a)(y.a)({minHeight:"100vh"}),Ba=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),Ma=function(){return c.a.createElement(Da,null,c.a.createElement(Ba,null,c.a.createElement(P,null,c.a.createElement(Ta,null))))},Fa={marginRight:"0.5em"},La=function(e){var t=e.personHistory,a=t.full_name,n=t.email,i=t.phone,o=t.website,l=t.votes,u=ke.a.compact(ke.a.uniq(l.map((function(e){return e.voteForPerson})))),s=Object(r.useState)([]),m=Object(D.a)(s,2),d=m[0],p=m[1],f=Object(r.useState)(l),h=Object(D.a)(f,2),v=h[0],E=h[1],y=function(e,t){var a=t.label,n=[];d.includes(a)?(n=ke.a.without(d,a),p(n)):(d.push(a),p(n=d)),ke.a.isEmpty(n)?E(l):E(ke.a.filter(l,(function(e){return n.includes(e.voteForPerson)})))},w=u.map((function(e,t){return c.a.createElement(fe.a,{style:Fa,key:t,label:e,onChange:y})}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.a,{as:"h1"},a),c.a.createElement(j.a,{columns:1,stackable:!0},c.a.createElement(j.a.Column,null,c.a.createElement(b.a,null,c.a.createElement(k.a,{as:"h2"},"Contact information"),c.a.createElement("strong",null,"Email:")," ",c.a.createElement("a",{href:"mailto:".concat(n)},n),c.a.createElement("div",null,c.a.createElement("strong",null,"Phone:")," ",i),c.a.createElement("div",null,c.a.createElement("strong",null,"Website:")," ",c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o},o)))),c.a.createElement(j.a.Column,null,c.a.createElement(b.a,null,c.a.createElement(k.a,{as:"h2"},"Voting record"),c.a.createElement(k.a,{as:"h3"},"Filter by vote cast"),c.a.createElement(V.a,null,w),c.a.createElement(ra,{votingData:v,isPerson:!0})))))},Na=Object(E.h)((function(e){var t=e.match.params.id,a=Xe("getVotesForPerson",[t],null),n=Object(D.a)(a,1)[0];return tt(n.data?n.data.full_name:"Loading..."),c.a.createElement(W,{apiState:n},c.a.createElement(La,{personHistory:n.data}))})),Ua=Object(w.a)(y.a)({minHeight:"100vh"}),qa=Object(w.a)(y.a)({marginTop:"2em !important",marginBottom:"5em !important"}),Ha=function(){return c.a.createElement(Ua,null,c.a.createElement(qa,null,c.a.createElement(P,null,c.a.createElement(Na,null))))};l.a.initialize("UA-145893191-1");var Ya=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(P,null,c.a.createElement(v.a,{basename:"/"},c.a.createElement(O,null),c.a.createElement(E.c,null,c.a.createElement(E.a,{exact:!0,path:"/",component:h(q)}),c.a.createElement(E.a,{path:"/search",component:h(dt)}),c.a.createElement(E.a,{exact:!0,path:"/events",component:h(_a)}),c.a.createElement(E.a,{path:"/events/:id",component:h(ka)}),c.a.createElement(E.a,{exact:!0,path:"/people",component:h(Ma)}),c.a.createElement(E.a,{exact:!0,path:"/people/:id",component:h(Ha)})),c.a.createElement(S,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(Ya,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[459,1,2]]]);
//# sourceMappingURL=main.d0faec09.chunk.js.map